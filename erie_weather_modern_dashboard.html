
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Metabolic Weather Display</title>
  <style>
    body {
      margin: 0;
      background-color: #0e2239;
      font-family: 'Segoe UI', sans-serif;
      color: white;
    }
    .container {
      padding: 2vw;
      display: flex;
      flex-direction: column;
      justify-content: center;
      height: 100vh;
      box-sizing: border-box;
    }
    .current {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
      text-align: left;
      padding-left: 3vw;
    }
    .current h1 {
      font-size: 3vw;
      margin: 0 0 0.5vw;
    }
    .current img {
      width: 7vw;
      height: auto;
      margin-bottom: 0.5vw;
    }
    .current .temp {
      font-size: 6vw;
      font-weight: bold;
      margin: 0.5vw 0;
    }
    .current .summary, .current .details, .current .description {
      font-size: 1.5vw;
      margin: 0.3vw 0;
    }
    .forecast {
      flex: 1;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 2vw;
    }
    .day {
      background-color: #163b5c;
      padding: 1vw;
      border-radius: 1vw;
      width: 12vw;
      text-align: center;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    .day.highlight {
      border: 2px solid #5dade2;
    }
    .day h3 {
      margin: 0.5vw 0;
      font-size: 1.5vw;
    }
    .day img {
      width: 5vw;
      height: auto;
    }
    .day p {
      margin: 0.3vw 0;
      font-size: 1.2vw;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="current">
      <h1>Current Weather</h1>
      <img id="weatherIcon" src="" alt="icon"/>
      <div class="summary" id="weatherMain">Loading...</div>
      <div class="temp" id="temp">--°F</div>
      <div class="details" id="details">Wind: -- mph | Humidity: --%</div>
      <div class="description" id="description">Fetching detailed forecast...</div>
    </div>
    <div class="forecast" id="forecast">
      <!-- Forecast will populate here -->
    </div>
  </div>

  <script>
    const apiKey = "83a7310014209ebb5b1ddd11ec0e47f3";
    const lat = 42.1292;
    const lon = -80.0851;

    const weatherIcon = document.getElementById("weatherIcon");
    const weatherMain = document.getElementById("weatherMain");
    const temp = document.getElementById("temp");
    const details = document.getElementById("details");
    const description = document.getElementById("description");
    const forecast = document.getElementById("forecast");

    function titleCase(str) {
      return str.toLowerCase().replace(/(^|\s)\S/g, t => t.toUpperCase());
    }

    function getDay(dt) {
      return new Date(dt * 1000).toLocaleDateString("en-US", { weekday: 'short' });
    }

    async function getWeather() {
      try {
        const response = await fetch(
          `https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&exclude=minutely,alerts&units=imperial&appid=${apiKey}`
        );
        const data = await response.json();

        const current = data.current;
        const today = data.daily[0];
        const icon = current.weather[0].icon;
        weatherIcon.src = `https://openweathermap.org/img/wn/${icon}@4x.png`;
        weatherMain.textContent = titleCase(current.weather[0].description);
        temp.textContent = `${Math.round(current.temp)}°F`;
        details.textContent = `Wind: ${Math.round(current.wind_speed)} mph | Humidity: ${current.humidity}%`;
        description.textContent = `Expect ${current.weather[0].description} today with a high near ${Math.round(today.temp.max)}°F and low of ${Math.round(today.temp.min)}°F.`;

        let forecastHTML = "";
        data.daily.slice(0, 5).forEach((day, idx) => {
          const dayName = getDay(day.dt);
          const icon = day.weather[0].icon;
          const high = Math.round(day.temp.max);
          const low = Math.round(day.temp.min);
          const desc = titleCase(day.weather[0].description);

          forecastHTML += `
            <div class="day${idx === 0 ? " highlight" : ""}">
              <h3>${dayName}</h3>
              <img src="https://openweathermap.org/img/wn/${icon}@4x.png" alt="${desc}">
              <p>${desc}</p>
              <p>${high}° / ${low}°F</p>
            </div>`;
        });
        forecast.innerHTML = forecastHTML;
      } catch (err) {
        console.error(err);
        weatherMain.textContent = "Error fetching weather";
        description.textContent = "";
      }
    }

    getWeather();
    setInterval(getWeather, 15 * 60 * 1000);
  </script>
</body>
</html>
